include("leftof.jl")

function hull2d(p)
    #[v,i] = hull2d(p)     Convex hull of a set of 2D points.
    #p is a np x 2 array v is a (nv+1) x 2 array,
    #with the last point being a duplicate of the first,
    #(that way, plot(v(:,1),v(:,2)) yields a plot of the polygon)
    #and i is the index of each vertex in the p array.
    #v starts at the lower leftmost point and moves ccw around the hull.
    #
    # Author: Richard Schreier, Oregon State University. <schreier@ece.orst.edu>
    # Thanks to Ty Lasky of U.C. Davis for uncovering a bugs caused by the 
    # existence of multiple left-most and right-most points.

    #The algorithm was distilled by the author from an animated hull-finder called
    #XYZGeobench, which was at one time available from ftp://liasun3.epfl.ch/pub/ai/XYZ

    #Find the (lower)left-most and (upper)right-most points.
    if true
        p=[1.14929850456287	0.467608390746656	-0.214081723069553	1.10422816311424	0.422538049298028	-0.259152064518181	-0.940842178334390	0.377467707849401	1.69577759403319	1.01408748021698	0.332397366400773	-0.349292747415436	-1.03098286123165	0.287327024952145	1.60563691113594	0.923946797319727	0.242256683503517	-0.439433430312692	0.878876455871099	0.197186342054890	-0.484503771761320	0.833806114422471	0.152116000606262	-0.529574113209947	0.788735772973843	0.107045659157634	1.42535554534142	0.743665431525216	0.0619753177090063	-0.619714796107203	0.698595090076588	0.0169049762603786	-0.664785137555831	0.653524748627960	-0.0281653651882492	1.29014452099554	0.608454407179332	-0.0732357066368770	1.24507417954691	0.563384065730705	-0.118306048085505	-0.799996161901714	0.518313724282077	-0.163376389534132	1.15493349664966	0.473243382833449	-0.208446730982760	1.10986315520103	0.428173041384821	-0.253517072431388	1.06479281375240	0.383102699936194	-0.298587413880016	-0.980277527696225	0.338032358487566	1.65634224467136	0.974652130855147	0.292962017038938	-0.388728096777271	0.929581789406520	0.247891675590310	-0.433798438225899	0.884511447957892	0.202821334141682	-0.478868779674527	0.839441106509264	0.157750992693055	-0.523939121123155	0.794370765060636	0.112680651244427	1.43099053742822	0.749300423612008	0.0676103097957992	-0.614079804020410	0.704230082163381	0.0225399683471714	1.34084985453096	0.659159740714753	-0.0225303731014563	-0.704220486917666	0.614089399266125	-0.0676007145500841	1.25070917163371	0.569019057817497	-0.112671055998712	-0.794361169814921	0.523948716368870	-0.157741397447340	1.16056848873645	0.478878374920242	-0.202811738895967	1.11549814728782	0.433808033471614	-0.247882080344595	1.07042780583920	0.388737692022986	-0.292952421793223	1.02535746439057	0.343667350574359	-0.338022763241851	-1.01971287705806	0.298597009125731	1.61690689530952	0.935216781493312	0.253526667677103	-0.428163446139106	0.890146440044685	0.208456326228475	-0.473233787587734	0.845076098596057	0.163385984779848	-0.518304129036362	0.800005757147429	0.118315643331220	1.43662552951501	0.754935415698801	0.0732453018825920	-0.608444811933617	0.709865074250174	0.0281749604339643	-0.653515153382245	0.664794732801546	-0.0168953810146635	1.30141450516913	0.619724391352918	-0.0619657224632912	1.25634416372050	0.574654049904290	-0.107036063911919	-0.788726177728128	0.529583708455663	-0.152106405360547	1.16620348082324	0.484513367007035	-0.197176746809175	1.12113313937462	0.439443025558407	-0.242247088257802	-0.923937202074012	0.394372684109779	1.71268257029357	1.03099245647736	0.349302342661151	-0.332387771155058	-1.01407788497127	0.304232001212524	1.62254188739631	0.940851773580105	0.259161659763896	-0.422528454052313	0.895781432131477	0.214091318315268	-0.467598795500941	0.850711090682850	0.169020976866640	-0.512669136949569	0.805640749234222	0.123950635418013	-0.557739478398197	0.760570407785594	0.0788802939693849	1.39719018015318	0.715500066336966	0.0338099525207571	-0.647880161295452	0.670429724888339	-0.0112603889278706	1.30704949725592	0.625359383439711	-0.0563307303764984	-0.738020844192708	0.580289041991083	-0.101401071825126	1.21690881435866	0.535218700542455	-0.146471413273754	1.17183847291004	0.490148359093828	-0.191541754722382	-0.873231868538591	0.445078017645200	1.76338790382899	1.08169779001278	0.400007676196572	-0.281682437619637	-0.963372551435846	0.354937334747944	-0.326752779068265	0.991557107115526	0.309866993299317	-0.371823120516893	0.946486765666898	0.264796651850689	1.58310653803448	0.901416424218270	0.219726310402061	-0.461963803414148	-1.14365391723036	0.174655968953433	1.49296585513722	0.811275741321015	0.129585627504806	-0.552104486311404	0.766205399872387	0.0845152860561778	1.40282517223997	0.721135058423759	0.0394449446075500	-0.642245169208659	0.676064716975132	-0.00562539684107777	-0.687315510657287	0.630994375526504	-0.0506957382897055	1.26761414789409	0.585924034077876	-0.0957660797383333	1.22254380644546	0.540853692629248	-0.140836421186961	-0.822526535003170	0.495783351180620	-0.185906762635589	1.13240312354820	0.450713009731993	-0.230977104084217	1.08733278209957	0.405642668283365	-0.276047445532844	1.04226244065095	0.360572326834737	-0.321117786981472	0.997192099202319	0.315501985386109	-0.366188128430100	0.952121757753691	0.270431643937482	-0.411258469878728	0.907051416305063	0.225361302488854	-0.456328811327355	0.861981074856435	0.180290961040226	-0.501399152775983	0.816910733407808	0.135220619591598	1.45353050577539	0.771840391959180	0.0901502781429706	-0.591539835673239	0.726770050510552	0.0450799366943429	1.36338982287813	0.681699709061924	9.59524571508830e-06	-0.681680518570494	0.636629367613297	-0.0450607462029127	1.27324913998088	0.591559026164669	-0.0901310876515404	-0.771821201467750	0.546488684716041	-0.135201429100168	1.18310845708362	0.501418343267413	-0.180271770548796	1.13803811563499	0.456348001818786	-0.225342111997424	-0.907032225813633	0.411277660370158	1.72958754655395	1.04789743273774	0.366207318921530	-0.315482794894679	-0.997172908710889	0.321136977472902	1.63944686365669	0.957756749840484	0.276066636024275	-0.405623477791935	-1.08731359160814	0.230996294575647	1.54930618075944	0.867616066943228	0.185925953127019	-0.495764160689190	0.822545725494601	0.140855611678391	-0.540834502137818	0.777475384045973	0.0957852702297635	1.41409515641355	0.732405042597345	0.0507149287811357	-0.630975185035074	0.687334701148717	0.00564458733250794	-0.676045526483701	0.642264359700089	-0.0394257541161198	1.27888413206767	0.597194018251462	-0.0844960955647476	1.23381379061904	0.552123676802834	-0.129566437013375	-0.811256550829585	0.507053335354206	-0.174636778462003	1.14367310772179	0.461982993905578	-0.219707119910631	1.09860276627316	0.416912652456951	-0.264777461359259	1.05353242482453	0.371842311008323	-0.309847802807886	1.00846208337590	0.326771969559695	-0.354918144256514	0.963391741927277	0.281701628111067	-0.399988485705142	0.918321400478649	0.236631286662440	-0.445058827153770	0.873251059030021	0.191560945213812	-0.490129168602397	0.828180717581393	0.146490603765184	1.46480048994897	0.783110376132766	0.101420262316556	-0.580269851499653	0.738040034684138	0.0563499208679286	-0.625340192948281	0.692969693235510	0.0112795794193008	1.32958946560309	0.647899351786882	-0.0337907620293270	-0.715480875845536	0.602829010338255	-0.0788611034779547	1.23944878270584	0.557758668889627	-0.123931444926582	1.19437844125721	0.512688327440999	-0.169001786375210	-0.850691900191420	0.467617985992371	-0.214072127823838	1.10423775835995	0.422547644543744	-0.259142469272466	1.05916741691133	0.377477303095116	-0.304212810721094	1.01409707546270	0.332406961646488	-0.349283152169721	0.969026734014070	0.287336620197860	-0.394353493618349	0.923956392565442	0.242266278749232	-0.439423835066977	0.878886051116814	0.197195937300605	1.51550582348440	0.833815709668186	0.152125595851977	-0.529564517964232	0.788745368219558	0.107055254403349	-0.574634859412860	0.743675026770931	0.0619849129547214	-0.619705200861488	0.698604685322303	0.0169145715060937	1.33522445768988	0.653534343873675	-0.0281557699425341	-0.709845883758743	0.608464002425047	1.92677388860884	1.24508377479263	0.563393660976420	-0.118296452839790	-0.799986566655999	0.518323319527792	-0.163366794288417	-0.845056908104627	0.473252978079164	1.79156286426295	1.10987275044675	0.428182636630536	-0.253507477185673	-0.935197591001882	0.383112295181909	-0.298577818634301	1.01973206754949	0.338041953733281	-0.343648160082928	0.974661726100862	0.292971612284653	-0.388718501531556	0.929591384652235	0.247901270836025	-0.433788842980184	0.884521043203607	0.202830929387398	1.52114081557119	0.839450701754979	0.157760587938770	-0.523929525877440	0.794380360306351	0.112690246490142	-0.568999867326067	0.749310018857724	0.0676199050415143	1.38592979122531	0.704239677409096	0.0225495635928865	-0.659140550223323	0.659169335960468	-0.0225207778557412	1.29578910832805	0.614098994511840	-0.0675911193043690	-0.749281233120578	0.569028653063213	-0.112661460752997	1.20564842543079	0.523958311614585	-0.157731802201625	-0.839421916017834	0.478887970165957	1.79719785634975	1.11550774253354	0.433817628717329	-0.247872485098880	-0.929562598915089	0.388747287268701	-0.292942826547508	1.02536705963628	0.343676945820074	-0.338013167996136	0.980296718187655	0.298606604371446	-0.383083509444763	0.935226376739027	0.253536262922818	-0.428153850893391	0.890156035290400	0.208465921474190	1.52677580765798	0.845085693841772	0.163395580025563	-0.518294533790647	0.800015352393144	0.118325238576935	-0.563364875239274	0.754945010944516	0.0732548971283071	1.39156478331210	0.709874669495889	0.0281845556796794	-0.653505558136530	0.664804328047261	-0.0168857857689484	-0.698575899585158	0.619733986598633	-0.0619561272175762	1.25635375896621	0.574663645150005	-0.107026468666204	1.21128341751759	0.529593303701378	-0.152096810114832	-0.833786923931041	0.484522962252750	1.80283284843654	1.12114273462033	0.439452620804122	-0.242237493012087	-0.923927606828296	0.394382279355494	-0.287307834460715	1.03100205172308	0.349311937906867	-0.332378175909343	0.985931710274448	0.304241596458239	-0.377448517357970	0.940861368825820	0.259171255009611	-0.422518858806598	0.895791027377193	0.214100913560983	-0.467589200255226	0.850720685928565	0.169030572112356	1.48734045829615	0.805650344479937	0.123960230663728	-0.557729883152482	0.760580003031309	0.0788898892151000	-0.602800224601109	0.715509661582682	0.0338195477664722	1.35212943395026	0.670439320134054	-0.0112507936821555	-0.692940907498365	0.625368978685426	-0.0563211351307833	1.26198875105301	0.580298637236798	-0.101391476579411	-0.783081590395620	0.535228295788170	1.85353818197196	1.17184806815575	0.490157954339543	-0.191532159476667	-0.873222273292876	0.445087612890915	-0.236602500925294	1.08170738525850	0.400017271442287	-0.281672842373922	1.03663704380987	0.354946929993659	-0.326743183822550	0.991566702361241	0.309876588545032	-0.371813525271178	0.946496360912613	0.264806247096404	-0.416883866719805	0.901426019463985	0.219735905647776	-0.461954208168433	0.856355678015358	0.174665564199148	-0.507024549617061	0.811285336566730	0.129595222750521	1.44790510893431	0.766214995118102	0.0845248813018928	-0.597165232514316	0.721144653669474	0.0394545398532651	-0.642235573962944	0.676074312220847	-0.00561580159536268	1.31269408458843	0.631003970772219	-0.0506861430439904	-0.732376256860200	0.585933629323591	1.90424351550738	1.22255340169117	0.540863287874963	-0.140826825941246	-0.822516939757455	0.495792946426336	-0.185897167389874	1.13241271879392	0.450722604977708	-0.230967508838501	-0.912657622654711	0.405652263529080	1.72396214971287	1.04227203589666	0.360581922080452	-0.321108191735757	-1.00279830555197	0.315511580631825	1.63382146681562	0.952131352999406	0.270441239183197	-0.411248874633013	-1.09293898844922	0.225370897734569	1.54368078391836	0.861990670102151	0.180300556285941	-0.501389557530268	0.816920328653523	0.135230214837313	-0.546459898978896	0.771849987204895	0.0901598733886857	1.40846975957248	0.726779645756267	0.0450895319400579	-0.636600581876151	0.681709304307639	1.91904914301766e-05	-0.681670923324779	0.636638962859012	1.95494884904280	1.27325873522659	0.591568621410384	-0.0901214924058253	-0.771811606222035	0.546498279961756	-0.135191833854453	-0.816881947670662	0.501427938513128	-0.180262175303081	1.13804771088071	0.456357597064501	-0.225332516751709	1.09297736943208	0.411287255615873	-0.270402858200336	1.04790702798345	0.366216914167245	-0.315473199648964	1.00283668653483	0.321146572718617	-0.360543541097592	0.957766345086199	0.276076231269990	-0.405613882546220	0.912696003637571	0.231005889821362	-0.450684223994847	0.867625662188943	0.185935548372734	-0.495754565443475	0.822555320740316	0.140865206924106	1.45917509310790	0.777484979291688	0.0957948654754786	-0.585895248340731	0.732414637843060	0.0507245240268508	-0.630965589789359	0.687344296394432	0.00565418257822303	1.32396406876201	0.642273954945805	-0.0394161588704047	-0.721106272686614	0.597203613497177	1.91551349968097	1.23382338586476	0.552133272048549	-0.129556841767660	-0.811246955583870	0.507062930599921	-0.174627183216288	-0.856317297032497	0.461992589151294	1.78030247533508	1.09861236151888	0.416922247702666	-0.264767866113544	-0.946457979929753	0.371851906254038	-0.309838207562171	1.00847167862162	0.326781564805410	-0.354908549010799	0.963401337172992	0.281711223356782	-0.399978890459427	0.918330995724364	0.236640881908155	1.55495076809195	0.873260654275736	0.191570540459527	-0.490119573356682	0.828190312827108	0.146500199010899	-0.535189914805310	0.783119971378481	0.101429857562271	-0.580260256253938	0.738049629929853	0.0563595161136437	1.37466940229743	0.692979288481225	0.0112891746650159	-0.670400939151193	0.647908947032597	-0.0337811667836119	1.28452871940018	0.602838605583970	-0.0788515082322396	-0.760541622048449	0.557768264135342	-0.123921849680867	1.19438803650292	0.512697922686714	-0.168992191129495	1.14931769505430	0.467627581238086	-0.214062532578123	1.10424735360567	0.422557239789459	-0.259132874026751	-0.940822987842960	0.377486898340831	1.69579678452462	1.01410667070841	0.332416556892203	-0.349273556924006	-1.03096367074022	0.287346215443575	1.60565610162737	0.923965987811157	0.242275873994948	-0.439414239821262	0.878895646362529	0.197205532546320	-0.484484581269889	0.833825304913901	0.152135191097692	-0.529554922718517	0.788754963465274	0.107064849649064	1.42537473583286	0.743684622016646	0.0619945082004365	-0.619695605615773	0.698614280568018	0.0169241667518087	-0.664765947064401	0.653543939119390	-0.0281461746968190	1.29016371148697	0.608473597670763	-0.0732165161454468	1.24509337003834	0.563403256222135	-0.118286857594075	-0.799976971410284	0.518332914773507	-0.163357199042702	1.15495268714109	0.473262573324879	-0.208427540491330	1.10988234569246	0.428192231876251	-0.253497881939958	1.06481200424383	0.383121890427624	-0.298568223388586	-0.980258337204795	0.338051548978996	1.65636143516279	0.974671321346577	0.292981207530368	-0.388708906285841	0.929600979897950	0.247910866081740	-0.433779247734469	0.884530638449322	0.202840524633113	-0.478849589183097	0.839460297000694	0.157770183184485	-0.523919930631724	0.794389955552066	0.112699841735857	1.43100972791965	0.749319614103439	0.0676295002872294	-0.614060613528980	0.704249272654811	0.0225591588386016	-0.659130954977608	0.659178931206183	-0.0225111826100262	1.29579870357376	0.614108589757555	-0.0675815240586539	1.25072836212514	0.569038248308928	-0.112651865507282	-0.794341979323491	0.523967906860300	-0.157722206955909	1.16058767922788	0.478897565411672	-0.202792548404537	1.11551733777925	0.433827223963044	-0.247862889853165	1.07044699633063	0.388756882514417	-0.292933231301793	-0.974623345118002	0.343686541065789	1.66199642724958	0.980306313433370	0.298616199617161	-0.383073914199048	0.935235971984743	0.253545858168533	-0.428144255647676	0.890165630536115	0.208475516719906	-0.473214597096304	0.845095289087487	0.163405175271278	-0.518284938544932	0.800024947638859	0.118334833822650	1.43664472000644	0.754954606190232	0.0732644923740222	-0.608425621442187	0.709884264741604	0.0281941509253945	-0.653495962890815	0.664813923292976	-0.0168761905232333	1.30143369566056	0.619743581844348	-0.0619465319718611	1.25636335421193	0.574673240395720	-0.107016873420489	-0.788706987236698	0.529602898947093	-0.152087214869117	1.16622267131467	0.484532557498465	-0.197157556317744	1.12115232986605	0.439462216049837	-0.242227897766372	-0.923918011582581	0.394391874601209	1.71270176078500	1.03101164696879	0.349321533152582	-0.332368580663628	-1.01405869447984	0.304251191703954	1.62256107788774	0.940870964071535	0.259180850255326	-0.422509263560883	0.895800622622908	0.214110508806698	-0.467579605009511	0.850730281174280	0.169040167358071	-0.512649946458139	0.805659939725652	0.123969825909443	-0.557720287906766	0.760589598277024	0.0788994844608151	1.39720937064461	0.715519256828397	0.0338291430121873	-0.647860970804022	0.670448915379769	-0.0112411984364404	1.30706868774735	0.625378573931141	-0.0563115398850682	-0.738001653701278	0.580308232482513	-0.101381881333696	1.21692800485009	0.535237891033886	-0.146452222782324	1.17185766340147	0.490167549585258	-0.191522564230952	-0.873212678047161	0.445097208136630	1.76340709432042	1.08171698050421	0.400026866688002	-0.281663247128207	-0.963353360944416	0.354956525239375	-0.326733588576835	0.991576297606956	0.309886183790747	-0.371803930025463	0.946505956158328	0.264815842342119	1.58312572852591	0.901435614709701	0.219745500893491	-0.461944612922718	-1.14363472673893	0.174675159444863	1.49298504562865	0.811294931812445	0.129604817996236	-0.552085295819974	0.766224590363817	0.0845344765476079	1.40284436273140	0.721154248915189	0.0394641350989802	-0.642225978717229	0.676083907466562	-0.00560620634964759	-0.687296320165857	0.631013566017934	-0.0506765477982754	1.26763333838552	0.585943224569306	-0.0957468892469031	1.22256299693689	0.540872883120678	-0.140817230695531	-0.822507344511740	0.495802541672051	-0.185887572144159	1.13242231403963	0.450732200223423	-0.230957913592786	1.08735197259100	0.405661858774795	-0.276028255041414	1.04228163114238	0.360591517326167	-0.321098596490042	0.997211289693749	0.315521175877540	-0.366168937938670	0.952140948245121	0.270450834428912	-0.411239279387297	0.907070606796493	0.225380492980284	-0.456309620835925	0.862000265347866	0.180310151531656	-0.501379962284553	0.816929923899238	0.135239810083029	1.45354969626682	0.771859582450610	0.0901694686344008	-0.591520645181809	0.726789241001982	0.0450991271857730	1.36340901336956	0.681718899553355	2.87857371452649e-05	-0.681661328079064	0.636648558104727	-0.0450415557114825	1.27326833047231	0.591578216656099	-0.0901118971601103	-0.771802010976320	0.546507875207471	-0.135182238608738	1.18312764757505	0.501437533758844	-0.180252580057366	1.13805730612643	0.456367192310216	-0.225322921505994	-0.907013035322203	0.411296850861588	1.72960673704538	1.04791662322917	0.366226509412960	-0.315463604403249	-0.997153718219458	0.321156167964332	1.63946605414812	0.957775940331914	0.276085826515705	-0.405604287300505	-1.08729440111671	0.231015485067077	1.54932537125087	0.867635257434658	0.185945143618449	-0.495744970197760	0.822564915986031	0.140874802169821;
        1.61422373270613	1.08183212345278	-0.132249599616770	1.97197856349747	1.39451661279550	0.135364548277315	-1.80547763005708	-0.428009922207675	2.26776767182552	2.28185515204250	1.61425251844327	0.264959771027834	-1.76602309020381	-0.478696065251667	2.12694084588427	2.05088764320400	1.29314432670751	-0.146289103605179	1.73258735226592	0.929773694320809	-0.554730077440511	1.27907603698196	0.431192037588222	-1.09838207562173	0.690353697352118	-0.202600643490248	2.22275490185118	1.96642033337639	1.02839565108540	-0.591319145021805	1.10727594505478	0.124180921315161	-1.54060421624067	0.112920532387291	-0.915244832800959	1.37489968819458	0.983354095373915	-0.0898816112629619	2.15519256828395	1.71857663401466	0.600270585929152	-1.19972557597256	0.318588148309514	-0.844788241224618	1.31014525542504	0.783388638258489	-0.425058092724271	1.68480506247676	1.11297810386158	-0.140538968569808	1.92425384518259	1.30735654511879	0.00876913123877232	-1.97150839645745	-0.633476037969887	2.02286620670147	1.99751833755662	1.29048035459555	-0.0982477421817172	1.83133404722480	1.07922572281511	-0.354572715410787	1.52993873254710	0.732760066688787	-0.746108712985740	1.09333239352352	0.251083386216579	-1.27285573490658	0.521515030154060	-0.365804318601513	2.06518621882670	1.81448664243871	0.882096952234512	-0.731982851785898	0.972247230377482	-0.00521280127534651	2.33563705325562	1.99479679397037	0.972266420868912	-0.731954066048754	0.882135333217371	-0.185465381332713	2.06524379030099	1.63426284811849	0.521591792119779	-1.27276937769514	0.251179338673727	-0.906562058773613	1.25400642996284	0.732884804883080	-0.469926934012888	1.64557121327494	1.07937924674655	-0.168502833598045	1.90192497224115	1.29066266426414	-0.00228975752908633	2.02306770686148	1.36673505743584	0.0287122941939895	-1.99100058286407	-0.692403573738340	1.92450332157118	1.85972010306449	1.11324677074160	-0.314916675397510	1.57522976464717	0.783686090875650	-0.689547696712084	1.15552840188397	0.318914386663820	-1.19938974237254	0.600616014774887	-0.281068341893893	2.15555718762112	1.91049260331992	0.983737905202510	-0.624706906731107	1.08515816751907	0.113333127953031	-1.54018202542921	0.124612707372331	-0.892282673642332	1.40913183152679	1.02885622287971	-0.0331094995835783	2.22323466413692	1.79788871404121	0.690852650129292	-1.09787352759884	0.431710180856826	-0.720396224503720	1.44580725631952	0.930320623326558	-0.266856123482616	1.85427701589200	1.29372004145041	0.0514729531926041	-1.87246424888141	-0.478091564771629	2.23459100552194	2.26558346199930	1.61488580466045	0.282498033505395	-1.73157985146587	-0.427347850253349	2.19519403714297	2.13604581072307	1.39520747048697	-0.0273209835653472	1.86846044856613	1.08255176688140	-0.385047028619543	1.46566406206331	0.634685038929947	-0.877984098019622	0.927656651214600	0.0516072866326123	-1.50613219176558	0.254438216020009	-0.666681490010606	1.73050869014257	1.44600875647954	0.479818709000293	-1.16806145229516	0.502368272593180	-0.508892116334691	1.79815738092123	1.42351676436094	0.367186033984441	-1.37083481020827	0.209454231782816	-0.891946840042310	1.32496197431635	0.860180674858810	-0.286290738414944	1.88554773449509	1.37569609358892	0.184154338866538	-1.68907752967205	-0.243999512026853	2.51938839180214	2.60108618181492	2.00109385801149	0.719411420391854	-1.24396113104399	0.110976203703951	-1.21577657536431	0.775780531751212	0.0856475250505286	-1.28617559546636	0.660311170200534	-0.0748921779487775	2.50821436008570	2.40963078430397	1.62935709470603	0.167393291291885	-1.97626062593847	-0.801604656985040	1.69136119815218	1.50263693947320	0.632222566978004	-0.919881919333399	0.846323480538987	-0.0691612334048348	2.33366393883513	2.05479899725889	1.09424394186644	-0.548001227342216	1.12806348963292	0.122438092791838	-1.56487741786545	0.0661169576610541	-0.984578780628652	1.28303536726543	0.868959401343309	-0.226806678395024	1.99573712805043	1.53659082067968	0.395754399492720	-1.42677213551045	0.0690112156701703	-1.11689554696542	1.01550757658278	0.466220586314776	-0.764756517769441	1.32257626433013	0.728218932613498	-0.547828512919346	1.49443392773160	0.855006254566338	-0.466111532415135	1.53108056678718	0.846582552173293	-0.519605576256807	1.43251618149688	0.702947825434366	-0.708310644444362	1.19874077186070	0.424102074349555	-1.03222673697780	0.829754337878635	0.0100452989188606	-1.49135385385712	0.325556879550685	-0.539222500857717	1.91430800491767	1.68614839687685	0.776298675019822	-0.815241160653417	0.911528889857135	-0.0433911734485217	2.31999864942961	2.00169835849154	1.00170795373725	-0.679972564833244	0.956656802780053	-0.0884039434228601	2.18484519655802	1.77640422272269	0.686273135071146	-1.08554806639660	0.460940618319438	-0.674260810780731	1.50884764630289	1.01026598957031	-0.170005780978491	1.96803233465650	1.42438033647529	0.199038224477865	-1.70799400133577	-0.296716340965610	2.43287120558834	2.48076863832608	1.84697595724761	0.531493162352928	-1.46567974635796	-0.144542768885059	2.49490409477163	2.45266084461212	1.72872748063639	0.323104002844457	-1.76420958876369	-0.533213294188041	2.01609288657140	1.88370895351462	1.06963490664164	-0.426129254047547	1.39641647144705	0.537272083125445	-1.00356241901237	0.773912965033599	-0.130301764736637	2.28379339167692	2.01619843427426	1.06691336305540	-0.564061821979676	1.12327287916904	0.128917466501549	-1.54712805998215	0.0951362997179372	-0.944289454398183	1.33459467766949	0.931788695920950	-0.152707399643798	2.08110639097525	1.63323006777808	0.503663630764704	-1.30759292006488	0.199460415289325	-0.975176363172678	1.16849674454911	0.630479738454688	-0.589227381455943	1.50937538481722	0.926288037274167	-0.338489424085092	1.71504300073944	1.08688531174776	-0.222962491060123	1.78549959231578	1.11227156187548	-0.242646582381038	1.72074515954624	1.00244678765731	-0.397541698047836	1.52077970243081	0.757410989093252	-0.687647838060518	1.18560322096950	0.377164166183315	-1.11296500241908	0.715215715162311	-0.138293681072505	2.32650680887647	2.10961718500923	1.21103744732579	-0.369232404173862	1.36880763051028	0.425157551378204	-1.20018264157008	0.492787051665433	-0.495933368915266	1.83365609668783	1.48155544847471	0.447764686445381	-1.26771618940016	0.335112820938099	-0.743748282539856	1.49570050016598	1.05345916905561	-0.0704722758709762	2.12390616538623	1.63659449282723	0.467592706452020	-1.38309919373940	0.0845187922529718	-1.12955333557087	0.974684422789086	0.397232067332830	-0.861910401939636	1.19725701497169	0.574734318066805	-0.729478492654289	1.28461858280841	0.617025544454896	-0.732257607714825	1.23676912629924	0.524105746497104	-0.870247747121245	1.05370864544420	0.295974924193429	-1.14344891087355	0.735437140243266	-0.0673669224561295	2.44813890102827	2.28195461069645	1.43408020654843	-0.0954843114158042	1.69326105680375	0.800316311207103	-0.774318548205757	0.969356478565174	0.0313413915198952	-1.58836380934159	0.110240875980710	-0.872844552513196	1.46237990517669	1.11591424905036	0.0877584791078292	-1.62208740465091	-0.0136234022258668	2.91315048638297	3.15823426117560	2.72162792215202	1.60333146931223	-0.196655097343770	1.32166822218402	0.158301427895605	-1.68675548020902	-0.213502502129858	2.57806036213310	2.68793311257984	2.11611574921038	0.862608272024705	-1.07258931897718	0.310522976204731	-0.988054842429570	1.03167722511992	0.369719178853201	-0.973928981229728	1.00073274487113	0.293704357155788	-1.09501414437577	0.834577240276466	0.0824785111124911	-1.35131033186769	0.533210711335914	-0.263958359276689	2.25718245629450	2.09663315804948	1.25439374598825	-0.269535779889192	1.52484458041716	0.637534826907302	-0.931465040418766	0.817844978438958	-0.114535116519528	2.27139467470578	1.97563435211487	0.998183915707759	-0.660956634515564	0.998212701444904	-0.0243080764108374	2.27148103191721	1.88558002642905	0.817988907124683	-0.931292325995895	0.637736327067317	-0.474925133685680	1.73072329174511	1.25468160335970	0.0969498011580741	-1.74247211485976	-0.263584144693803	2.53361371165594	2.64912145418948	2.08293908290681	0.835066597807933	-1.09449600110716	0.294251286161544	-0.998691540385964	1.02667551925032	0.370352465070393	-0.967660702925743	1.01263601526191	0.311242619633358	-1.07184088981141	0.863385486927622	0.116921749850440	-1.31123210104295	0.578923934247448	-0.212610144278361	2.31416566337962	2.15925135722139	1.32264693724695	-0.195647596543693	1.60436775584945	0.722692994426386	-0.840671880812888	0.914273130131628	-0.0124719727400648	2.37909281057203	2.08896748006792	1.11715203574760	-0.536353522388930	1.12845080565833	0.111565019889383	-1.58701087969578	0.0327231069028580	-1.02923302031472	1.22712073865150	0.801784383801502	-0.305242084864702	1.90604133265288	1.43563463635426	0.283537826239430	-1.55024909769161	-0.0657261354388612	2.73710671299768	2.85824944761801	2.29770206842213	1.05546457541005	-0.868463031418251	0.525919247937243	-0.761388586523472	1.26961346519960	0.618925403106471	-0.713452772802872	1.27247893747158	0.576720533929814	-0.800727983428156	1.14013338539766	0.399304640407275	-1.02321421839932	0.872576808977869	0.0866777225388522	-1.38091147771637	0.469809208212191	-0.361160219675454	2.12618023862069	1.93183058310063	1.05579081376436	-0.501939069388125	1.25864093364318	0.337530822858284	-1.26526940174283	0.450240259839856	-0.515940192393672	1.83618924155659	1.50662856169064	0.495377768008489	-1.19756313948988	0.427805839195550	-0.628515295935233	1.63347345511777	1.21377209235457	0.112380615775161	-1.67070097462046	-0.135472678832289	2.71806550313967	2.88991357129542	2.38007152563497	1.18853936615830	-0.684682907134577	0.760404705756338	-0.476197795168956	1.60550959008954	1.00552686153183	-0.276145980842095	1.76049106296777	1.11543799296143	-0.211305190861117	1.78026151150012	1.09013810004516	-0.281675425226023	1.66482093568659	0.929627182782994	-0.487256683936811	1.41416933552717	0.633905241174950	-0.828048966993483	1.02830671102187	0.202972275221023	-1.30405227439604	0.507233062170691	-0.363171715078788	2.08473339385552	1.85094838897363	0.935473270275518	-0.661691962238798	1.05945269143068	0.0989072312839410	-1.54332834267900	0.132745969541843	-0.872869832053520	1.43982425253491	1.07082822330713	0.0201420802631369	-1.71223417659706	-0.126300547273472	2.77794296823391	3.00049636992508	2.54135965780004	1.40053283185880	-0.421984107898657	1.07380883852768	-0.112088328862195	2.02032438993172	1.47104699490943	0.240079486070929	-1.67257813658378	-0.266925873054702	2.45703627665817	2.49930831255483	1.85989023463528	0.538782042899525	-1.46401626265244	-0.148504682020618	2.48531678479500	2.43744813779440	1.70788937697760	0.296640502344588	-1.79629848610463	-0.570927588370065	1.97275319554829	1.83474386565044	1.01504442193639	-0.486345135593882	1.33057519305964	0.465805407896953	-1.08065449108194	0.691195496122952	-0.218644630488362	2.18982512908411	1.91660477484038	0.961694306780439	-0.674906275095712	1.00680302921193	0.00682221970335717	-1.67484870362142	-0.0382097407624107	2.91673910828039	3.18999784350698	2.78156646491737	1.69144497251154	-0.0803666337104914	1.46613164625126	0.330939812396811	-1.48594213527385	0.0154858032392768	-1.16477637206380	0.973271338816906	0.429628935881407	-0.795703580870302	1.29727378856178	0.708561044177652	-0.561841814022684	1.48606521396077	0.852282128128015	-0.463191071520949	1.53964561501388	0.860792187732495	-0.499751353365097	1.45801499172110	0.734091222991091	-0.671522659555129	1.24117334408244	0.472179233903804	-0.978504990091044	0.889120672097900	0.0750562204706335	-1.42069834497284	0.401856975767474	-0.457277817308420	2.00189727579948	1.77938225509116	0.875177120566643	-0.710718127774087	1.02169651006897	0.0724210340958233	-1.55854455569354	0.128799740700897	-0.865546076720880	1.45841799204113	1.10069194698694	0.0612757881165336	-1.65983048457008	-0.0626268710729039	2.85288662860806	3.08671001447282	2.63884328652137	1.50928644475371	-0.301960510830160	1.20510241976976	0.0304752365534731	-1.82584206047902	-0.363849471327731	2.41645300400735	2.51506536552623	1.93198761322889	0.667219747115350	-1.27923823281440	0.0926136734396348	-1.21722453412254	0.791247144499083	0.118028709304493	-1.23687983970631	0.726521497466685	0.00823272082346782	-1.39174616963596	0.526584826088405	-0.236774292003441	2.31817647608851	2.19143713036424	1.38300767082377	-0.107111902532915	1.72107841029419	0.867578609305093	-0.667611305500217	1.11550866587826	0.216938523440535	-1.36332173281340	0.374727897116449	-0.568912586769907	1.80575681552753	1.49873610400875	0.510025278673768	-1.16037566047743	0.487533286555172	-0.546247880228440	1.73828083917174	1.34111944475571	0.262267936523468	-1.49827368552498	0.0594945786103613	-1.06442727107051	1.12996076543242	0.642658688119131	-0.526333503010364	1.62298419204393	1.09061177328202	-0.123450759296105	1.98079659430956	1.40335383409902	0.144220960072271	-1.79660202777069	-0.419115129429859	2.27668165509476	2.29078832580317	1.62320488269538	0.273931325771372	-1.75703234496884	-0.469686129525269	2.13596997210210	2.05993595991325	1.30221183390820	-0.137202405913061	1.74169324044947	0.938898772995788	-0.545585808274102	1.28823949663980	0.440374687737491	-1.08918023498103	0.699574728484248	-0.193360421866688	2.23201431396617	1.97569893598281	1.03769344418325	-0.582002161432524	1.11661211913549	0.133536285887302	-1.53122966117710	0.122314277942292	-0.905831896754527	1.38433181473244	0.992805412403207	-0.0804111037422401	2.16468226629610	1.72808552251824	0.609798664924164	-1.19017830648612	0.328154608287387	-0.835202590755316	1.31975009638577	0.793012669710652	-0.415414870780678	1.69446747491178	1.12265970678803	-0.130838175151925	1.93397382909191	1.31709571951953	0.0185274961309463	-1.96173084107385	-0.623679292094853	2.03268214306793	2.00735346441451	1.30033467194488	-0.0883742343409613	1.84122674555699	1.08913761163873	-0.344641636095741	1.53988900235358	0.742729526986694	-0.736120062196403	1.10334023480429	0.261110417988776	-1.26280951264295	0.531580442909118	-0.355719715355025	2.07529001256462	1.82460962666806	0.892239126955291	-0.721821486573689	0.982427786081122	0.00498694491972329	-1.65414401005788	0.00503492114829829	-1.01747626146173	1.27832244211204	0.892431031869592	-0.175150492189062	2.07557786993607	1.64461611824500	0.531964252737720	-1.26237772658577	0.261590180274529	-0.896132026681381	1.26445565254650	0.743353217958173	-0.459439330446365	1.65607800733289	1.08990523129593	-0.157957658557232	1.91248933777339	1.30124622028781	0.00831298898601718	-1.96631035613198	-0.622623815066196	2.03937261218338	2.01967892561675	1.31829512523392	-0.0647787889651332	1.87045718301961	1.12400304118814	-0.304141214459534	1.58602441607658	0.794499932796486	-0.678714664299818	1.16638062478767	0.329785800058947	-1.18849913848598	0.611525809152874	-0.270139357024476	2.16650536298196	1.92145996917220	0.994724461546218	-0.613701159895969	1.09618310484563	0.124377255771029	-1.52911870711979	0.135695216173190	-0.881180974350044	1.42025272131051	1.03999630315486	-0.0219502288169993	2.23441312539493	1.80908636579065	0.702069492370162	-1.08663749486654	0.442965404080556	-0.709121810788561	1.45710086052611	0.941633418024578	-0.255524138293166	1.86562819157288	1.30509040762272	0.0628625098563449	-1.86105550172624	-0.466663627125027	2.24603813365997	2.27704978062876	1.62637131378135	0.294002733117717	-1.72005596136212	-0.415804769658166	2.20675630822958	2.14762727230111	1.40680812255644	-0.0157011410044439	1.88009948161846	1.09420999042516	-0.373369614584349	1.47736066658993	0.646400833948001	-0.866249112510137	0.939410827215515	0.0633806531249574	-1.49433963478181	0.266249963495215	-0.654850552043970	1.74235881860064	1.45787807542903	0.491707218441220	-1.15615375236280	0.514295163016967	-0.496946035419474	1.81012265232788	1.43550122625902	0.379189686373949	-1.35881196732733	0.221496265155185	-0.879885616178511	1.33704238867158	0.872280279705469	-0.274171943076855	1.89768572032461	1.38785326990987	0.196330705678919	-1.67688197236824	-0.231784764231612	2.53162233008881	2.61333931059302	2.01336617728102	0.731702930152814	-1.23165043079160	0.123306094447773	-1.20342749412906	0.788148803477894	0.0980349872686404	-1.27376894275682	0.672737013401506	-0.0624471442563752	2.52067858426953	2.42211419897923	1.64185969987273	0.179915086950007	-1.96371963978892	-0.789044480344057	1.70394056528460	1.51523549709704	0.644840315093278	-0.907244980726695	0.858979609637122	-0.0564859138152705	2.34635844891613	2.06751269783132	1.10697683293030	-0.535249145786932	1.14083476167963	0.135228555329982	-1.55206776483588	0.0789458011820585	-0.971730746616217	1.29590259176930	0.881845816338604	-0.213901072908299	2.00866192402859	1.54953480714927	0.408717576453736	-1.41378976805800	0.0820127736140464	-1.10387479853011	1.02854751550952	0.479279715732943	-0.751678197859844	1.33567377473116	0.741335633505955	-0.534692621535459	1.50758900960692	0.868180526933085	-0.452918069556957	1.54429322013679	0.859814396014331	-0.506354541924339	1.44578640632078	0.716237240749694	-0.695002038637604	1.21206856815889	0.437449061139174	-1.01886055969675	0.843139705651114	0.0234498571827699	-1.47793010510178	0.338999818797455	-0.525760371119517	1.92778932514730	1.69964890759791	0.789818376232313	-0.801702268949495	0.925086972052487	-0.0298139007617400	2.33359511260782	2.01531401216118	1.01534279789832	-0.666318530180741	0.970330027923986	-0.0747115277874968	2.19855680268481	1.79013501934091	0.700023122180800	-1.07177888879552	0.474728986411951	-0.660453252196787	1.52267439537827	1.02411192913711	-0.156140650920257	1.98191665520617	1.43828384751638	0.212960926010390	-1.69405210931181	-0.282755258450225	2.44685147859515	2.49476810182432	1.86099461123728	0.545531006834034	-1.45162271138542	-0.130466543421092	2.50899951072703	2.46677545105894	1.74286127757465	0.337256990274144	-1.75003741084257	-0.519021925775493	2.03030344547537	1.89793870291003	1.08388384652848	-0.411861123669279	1.41070379231675	0.551578594486573]
    end
    p=p'

    x = minimum(p[:,1])
    leftmost = findall(a->a==x,p[:,1])
    x1=minimum(p[leftmost,2])
    y=minimum(p[leftmost,2], dims = 1)
    indices=findall(b->b==y[1],p)
    il=indices[1][1]
    # il = leftmost[il]
    l = [x y]

    x = maximum(p[:,1])
    rightmost = findall(a->a==x,p[:,1])
    x1=maximum(p[rightmost,2])
    y=maximum(p[rightmost,2], dims = 1)
    indices=findall(b->b==y[1],p)
    ir=indices[1][1]
    # ir = rightmost[ir]
    r = [x y]

    if l==r		# Degenerate cases
        v = l
        i = il
        return
    end

    #Split the points into those above and those below the l-r line.
    isAbove = leftof(p,l,r)
    ia=findall(a->a==1,isAbove)
    ib=findall(a->a==0,isAbove)
    above = p[ia,:]
    below = p[ib,:]

    #Sort them in terms of increasing first coordinate.
    if any(x->x==1,isAbove)
        isort = sortperm(above[:,1])
        first=l
        second=above[isort,:]
        above = vcat(first,second)
        ia = vcat(il,ia[isort])
    else # no points above
        above = l
        ia = il
    end
    isort = sortperm(below[:,1])
    below = vcat(below[isort,:],r)	# includes the l and r points r must be last.
    ib = vcat(ib[isort],ir)

    #Move along the underside, building the vertex list as we go.
    a = below[1,:]
    a=a'
    nb = size(below,1)
    b = below[2,:]
    b=b'
    v = vcat(a,b)
    i = vcat(ib[1],ib[2])
    nv = 2
    # println("Before: ",size(v))
    count=0
    countone=0
    countzero=0
    for n=3:nb
        p = below[n,:]
        get=leftof(p',a,b)
        count=count+1
        println("Count: ",count)
        println("Value: ",get)
        if get==Bool[1]
            countone=countone+1
        end
        if get==Bool[0]
            countzero=countzero+1
        end
        if get==1
            cond=true
        else
            cond=false
        end
        while !cond
            # count=count+1
            # println("Count: ",count,"Get: ",cond)
            nv = nv-1
            v = v[1:nv,:]
            i = i[1:nv]
            b = a
            if nv>1
                a = v[nv-1,:]
            else
                break
            end
        end
        v = vcat(v,p')
        i = vcat(i,ib[n])
        nv = nv+1
        a = b
        b = p'
    end
    println("Count One: ",countone)
    println("Count Zero: ",countzero)
    # println("After: ",size(v))

    # na = size(above,1)
    # for n=na:-1:1
    #     p = above[n,:]
    #     get=leftof(p',a,b)
    #     while ~get && nv>2
    #         nv = nv-1
    #         v = v[1:nv,:]
    #         i = i[1:nv]
    #         b = a
    #         a = v[nv-1,:]
    #     end
    #     v = vcat(v,p')
    #     i = vcat(i,ia[n])
    #     nv = nv+1
    #     a = b
    #     b = p'
    # end
    
    return v,i
end
