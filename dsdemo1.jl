using Plots
#using PyPlot
using ControlSystems

pyplot()

#The 3 NTF from demo 1
H1 = tf([1,-5,10,-10,5,-1], [1,-4.19231428539401,7.08580075910220,-6.02958019623754,2.58119364847365,-0.444444444020463]) 
H2 = tf([1,-4.98929666328513,9.96791208834985,-9.96791208834985,4.98929666328513,
-1.00000000000000],[1,-4.18702296473404,7.06873226323112,-6.00870809167249,2.56974468437732,-0.442070331395993])
H3 = tf([1,-5.65624576264423,15.9965580637154,-28.2763614420573,33.9896743762743,-28.2763614420573
,15.9965580637154,-5.65624576264423,1.00000000000000],[1,-5.08108859129450,12.9171050698985,
-20.5765352821357,22.3363158697832,-16.8171402169019,8.62427391938743,-2.76865720734546,0.444220447957895])

#Plot Poles & Zeros 1
p1 = plot(overwrite_figure = false);
plot!(size = (650, 530), aspect_ratio = 1)
pzmap!(H1);
plot!(exp.(im*2*pi*(0:0.01:1)))

#Plot Poles & Zeros 2
p2 = plot(overwrite_figure = false);
plot!(size = (650, 530), aspect_ratio = 1)
pzmap!(H2);
plot!(exp.(im*2*pi*(0:0.01:1)))

#Plot Poles & Zeros 3
p3 = plot(overwrite_figure = false);
plot!(size = (650, 530), aspect_ratio = 1)
pzmap!(H3);
plot!(exp.(im*2*pi*(0:0.01:1)))


# Plot Mag 1
# f1 = LinRange(0,0.75/OSR,100)
# f2 = LinRange(0.75/OSR,0.5,100)
# f = [f1; f2]
# println(size(f));

# #z = exp.(2im*pi*f);
# #println(typeof(z));

# #zpk1 = zpk(H1)
# #z, p, k = zpkdata(zpk1);
# #h = k * evalRPoly(zs{1},z) ./ evalRPoly(ps{1},z)
# y = freqresp(H1, f)
# println(typeof(y));
# println(size(y))

# y2 = y[ : , 1 , 1]

# println(size(y2))

# y3 = 20*log10.(abs.(y2))

f = [0	0.000236742424242424	0.000473484848484849	0.000710227272727273	0.000946969696969697	0.00118371212121212	0.00142045454545455	0.00165719696969697	0.00189393939393939	0.00213068181818182	0.00236742424242424	0.00260416666666667	0.00284090909090909	0.00307765151515152	0.00331439393939394	0.00355113636363636	0.00378787878787879	0.00402462121212121	0.00426136363636364	0.00449810606060606	0.00473484848484849	0.00497159090909091	0.00520833333333333	0.00544507575757576	0.00568181818181818	0.00591856060606061	0.00615530303030303	0.00639204545454546	0.00662878787878788	0.00686553030303030	0.00710227272727273	0.00733901515151515	0.00757575757575758	0.00781250000000000	0.00804924242424242	0.00828598484848485	0.00852272727272727	0.00875946969696970	0.00899621212121212	0.00923295454545455	0.00946969696969697	0.00970643939393939	0.00994318181818182	0.0101799242424242	0.0104166666666667	0.0106534090909091	0.0108901515151515	0.0111268939393939	0.0113636363636364	0.0116003787878788	0.0118371212121212	0.0120738636363636	0.0123106060606061	0.0125473484848485	0.0127840909090909	0.0130208333333333	0.0132575757575758	0.0134943181818182	0.0137310606060606	0.0139678030303030	0.0142045454545455	0.0144412878787879	0.0146780303030303	0.0149147727272727	0.0151515151515152	0.0153882575757576	0.0156250000000000	0.0158617424242424	0.0160984848484848	0.0163352272727273	0.0165719696969697	0.0168087121212121	0.0170454545454545	0.0172821969696970	0.0175189393939394	0.0177556818181818	0.0179924242424242	0.0182291666666667	0.0184659090909091	0.0187026515151515	0.0189393939393939	0.0191761363636364	0.0194128787878788	0.0196496212121212	0.0198863636363636	0.0201231060606061	0.0203598484848485	0.0205965909090909	0.0208333333333333	0.0210700757575758	0.0213068181818182	0.0215435606060606	0.0217803030303030	0.0220170454545455	0.0222537878787879	0.0224905303030303	0.0227272727272727	0.0229640151515152	0.0232007575757576	0.0234375000000000	0.0234375000000000	0.0282512626262626	0.0330650252525253	0.0378787878787879	0.0426925505050505	0.0475063131313131	0.0523200757575758	0.0571338383838384	0.0619476010101010	0.0667613636363637	0.0715751262626263	0.0763888888888889	0.0812026515151515	0.0860164141414141	0.0908301767676768	0.0956439393939394	0.100457702020202	0.105271464646465	0.110085227272727	0.114898989898990	0.119712752525253	0.124526515151515	0.129340277777778	0.134154040404040	0.138967803030303	0.143781565656566	0.148595328282828	0.153409090909091	0.158222853535354	0.163036616161616	0.167850378787879	0.172664141414141	0.177477904040404	0.182291666666667	0.187105429292929	0.191919191919192	0.196732954545455	0.201546717171717	0.206360479797980	0.211174242424242	0.215988005050505	0.220801767676768	0.225615530303030	0.230429292929293	0.235243055555556	0.240056818181818	0.244870580808081	0.249684343434343	0.254498106060606	0.259311868686869	0.264125631313131	0.268939393939394	0.273753156565657	0.278566919191919	0.283380681818182	0.288194444444444	0.293008207070707	0.297821969696970	0.302635732323232	0.307449494949495	0.312263257575758	0.317077020202020	0.321890782828283	0.326704545454545	0.331518308080808	0.336332070707071	0.341145833333333	0.345959595959596	0.350773358585859	0.355587121212121	0.360400883838384	0.365214646464646	0.370028409090909	0.374842171717172	0.379655934343434	0.384469696969697	0.389283459595960	0.394097222222222	0.398910984848485	0.403724747474747	0.408538510101010	0.413352272727273	0.418166035353535	0.422979797979798	0.427793560606061	0.432607323232323	0.437421085858586	0.442234848484849	0.447048611111111	0.451862373737374	0.456676136363636	0.461489898989899	0.466303661616162	0.471117424242424	0.475931186868687	0.480744949494950	0.485558712121212	0.490372474747475	0.495186237373737	0.500000000000000]
mgH = [-Inf	-219.085622514424	-188.982634959776	-171.373529073794	-158.879683440391	-149.188718174859	-141.270637613225	-134.576010701157	-128.776876062258	-123.661691884279	-119.086018902876	-114.946834469642	-111.168070471234	-107.691959943816	-104.473599713179	-101.477393489976	-98.6746452525816	-96.0418835111298	-93.5596652776504	-91.2117038400812	-88.9842205248704	-86.8654547825231	-84.8452883473834	-82.9149530109825	-81.0668006347132	-79.2941201425227	-77.5909904281774	-75.9521610378294	-74.3729545625426	-72.8491861665734	-71.3770967635591	-69.9532971539089	-68.5747210341939	-67.2385852396353	-65.9423559234779	-64.6837196401990	-63.4605585033294	-62.2709287477752	-61.1130421516903	-59.9852498720779	-58.8860283273460	-57.8139668234660	-56.7677566715734	-55.7461815864004	-54.7481091888391	-53.7724834637391	-52.8183180469631	-51.8846902346949	-50.9707356237738	-50.0756433049992	-49.1986515423973	-48.3390438807323	-47.4961456313972	-46.6693206934709	-45.8579686723885	-45.0615222634995	-44.2794448719189	-43.5112284436270	-42.7563914858223	-42.0144772571729	-41.2850521108902	-40.5677039755314	-39.8620409601573	-39.1676900719777	-38.4842960359275	-37.8115202067675	-37.1490395653163	-36.4965457913054	-35.8537444061360	-35.2203539795073	-34.5961053944983	-33.9807411662309	-33.3740148097217	-32.7756902529630	-32.1855412916540	-31.6033510823466	-31.0289116710767	-30.4620235548235	-29.9024952733893	-29.3501430295077	-28.8047903351930	-28.2662676825171	-27.7344122371632	-27.2090675532539	-26.6900833080774	-26.1773150554587	-25.6706239966279	-25.1698767675339	-24.6749452416426	-24.1857063473329	-23.7020418990800	-23.2238384416765	-22.7509871067995	-22.2833834812854	-21.8209274865175	-21.3635232683726	-20.9110790972086	-20.4635072774049	-20.0207240659920	-19.5826495999303	-19.5826495999303	-11.6020422089614	-5.26969322995945	-0.787724081576259	1.71359674295744	2.80778923680751	3.23362810578108	3.39892830845937	3.46614419849364	3.49512039095399	3.50834629633548	3.51470652480450	3.51791137235846	3.51959495279076	3.52051292230242	3.52103044828228	3.52133113924562	3.52151068088978	3.52162058253237	3.52168940227170	3.52173340536141	3.52176208697426	3.52178111727738	3.52179395391774	3.52180274662424	3.52180885622971	3.52181315873956	3.52181622695929	3.52181844096529	3.52182005644190	3.52182124762977	3.52182213472255	3.52182280158950	3.52182330739240	3.52182369429573	3.52182399264466	3.52182422448144	3.52182440595905	3.52182454901449	3.52182466254006	3.52182475321085	3.52182482607429	3.52182488497386	3.52182493285593	3.52182497199374	3.52182500415198	3.52182503070877	3.52182505274641	3.52182507111963	3.52182508650695	3.52182509944978	3.52182511038225	3.52182511965413	3.52182512754849	3.52182513429545	3.52182514008286	3.52182514506476	3.52182514936788	3.52182515309698	3.52182515633892	3.52182515916598	3.52182516163859	3.52182516380734	3.52182516571482	3.52182516739693	3.52182516888406	3.52182517020202	3.52182517137275	3.52182517241500	3.52182517334484	3.52182517417601	3.52182517492040	3.52182517558820	3.52182517618828	3.52182517672827	3.52182517721485	3.52182517765379	3.52182517805015	3.52182517840834	3.52182517873221	3.52182517902514	3.52182517929010	3.52182517952970	3.52182517974621	3.52182517994165	3.52182518011781	3.52182518027623	3.52182518041826	3.52182518054512	3.52182518065785	3.52182518075737	3.52182518084447	3.52182518091982	3.52182518098402	3.52182518103754	3.52182518108082	3.52182518111414	3.52182518113776	3.52182518115188	3.52182518115657]
f2 = [0.000156250000000000	0.000249685929648241	0.000343121859296482	0.000436557788944724	0.000529993718592965	0.000623429648241206	0.000716865577889447	0.000810301507537689	0.000903737437185930	0.000997173366834171	0.00109060929648241	0.00118404522613065	0.00127748115577889	0.00137091708542714	0.00146435301507538	0.00155778894472362	0.00165122487437186	0.00174466080402010	0.00183809673366834	0.00193153266331658	0.00202496859296482	0.00211840452261307	0.00221184045226131	0.00230527638190955	0.00239871231155779	0.00249214824120603	0.00258558417085427	0.00267902010050251	0.00277245603015075	0.00286589195979900	0.00295932788944724	0.00305276381909548	0.00314619974874372	0.00323963567839196	0.00333307160804020	0.00342650753768844	0.00351994346733668	0.00361337939698493	0.00370681532663317	0.00380025125628141	0.00389368718592965	0.00398712311557789	0.00408055904522613	0.00417399497487437	0.00426743090452261	0.00436086683417085	0.00445430276381910	0.00454773869346734	0.00464117462311558	0.00473461055276382	0.00482804648241206	0.00492148241206030	0.00501491834170854	0.00510835427135678	0.00520179020100503	0.00529522613065327	0.00538866206030151	0.00548209798994975	0.00557553391959799	0.00566896984924623	0.00576240577889447	0.00585584170854271	0.00594927763819096	0.00604271356783920	0.00613614949748744	0.00622958542713568	0.00632302135678392	0.00641645728643216	0.00650989321608040	0.00660332914572864	0.00669676507537688	0.00679020100502513	0.00688363693467337	0.00697707286432161	0.00707050879396985	0.00716394472361809	0.00725738065326633	0.00735081658291457	0.00744425251256281	0.00753768844221106	0.00763112437185930	0.00772456030150754	0.00781799623115578	0.00791143216080402	0.00800486809045226	0.00809830402010050	0.00819173994974874	0.00828517587939699	0.00837861180904523	0.00847204773869347	0.00856548366834171	0.00865891959798995	0.00875235552763819	0.00884579145728643	0.00893922738693467	0.00903266331658291	0.00912609924623116	0.00921953517587940	0.00931297110552764	0.00940640703517588	0.00949984296482412	0.00959327889447236	0.00968671482412060	0.00978015075376884	0.00987358668341709	0.00996702261306533	0.0100604585427136	0.0101538944723618	0.0102473304020101	0.0103407663316583	0.0104342022613065	0.0105276381909548	0.0106210741206030	0.0107145100502513	0.0108079459798995	0.0109013819095477	0.0109948178391960	0.0110882537688442	0.0111816896984925	0.0112751256281407	0.0113685615577889	0.0114619974874372	0.0115554334170854	0.0116488693467337	0.0117423052763819	0.0118357412060302	0.0119291771356784	0.0120226130653266	0.0121160489949749	0.0122094849246231	0.0123029208542714	0.0123963567839196	0.0124897927135678	0.0125832286432161	0.0126766645728643	0.0127701005025126	0.0128635364321608	0.0129569723618090	0.0130504082914573	0.0131438442211055	0.0132372801507538	0.0133307160804020	0.0134241520100503	0.0135175879396985	0.0136110238693467	0.0137044597989950	0.0137978957286432	0.0138913316582915	0.0139847675879397	0.0140782035175879	0.0141716394472362	0.0142650753768844	0.0143585113065327	0.0144519472361809	0.0145453831658291	0.0146388190954774	0.0147322550251256	0.0148256909547739	0.0149191268844221	0.0150125628140704	0.0151059987437186	0.0151994346733668	0.0152928706030151	0.0153863065326633	0.0154797424623116	0.0155731783919598	0.0156666143216080	0.0157600502512563	0.0158534861809045	0.0159469221105528	0.0160403580402010	0.0161337939698492	0.0162272298994975	0.0163206658291457	0.0164141017587940	0.0165075376884422	0.0166009736180905	0.0166944095477387	0.0167878454773869	0.0168812814070352	0.0169747173366834	0.0170681532663317	0.0171615891959799	0.0172550251256281	0.0173484610552764	0.0174418969849246	0.0175353329145729	0.0176287688442211	0.0177222047738693	0.0178156407035176	0.0179090766331658	0.0180025125628141	0.0180959484924623	0.0181893844221106	0.0182828203517588	0.0183762562814070	0.0184696922110553	0.0185631281407035	0.0186565640703518	0.0187500000000000]
mgH2 = [-237.131226700427	-216.773825052548	-202.968397310900	-192.509067054044	-184.086175380812	-177.034510120227	-170.969491555886	-165.648609773934	-160.909058581170	-156.636231537008	-152.746392994655	-149.176498598214	-145.877893888436	-142.812242923060	-139.948802170799	-137.262539176070	-134.732800109233	-132.342344584723	-130.076632590252	-127.923288411648	-125.871691317629	-123.912658654638	-122.038197393821	-120.241307119536	-118.515822184993	-116.856284047249	-115.257837111595	-113.716143074265	-112.227309955907	-110.787832902349	-109.394544486194	-108.044572736269	-106.735305496343	-105.464360001204	-104.229556779611	-103.028897166058	-101.860543838582	-100.722803906766	-99.6141141591686	-98.5330281475212	-97.4782048399267	-96.4483986197545	-95.4424504431434	-94.4592799976881	-93.4978787292851	-92.5573036242902	-91.6366716508892	-90.7351547775538	-89.8519754981470	-88.9864028030761	-88.1377485441793	-87.3053641480558	-86.4886376385123	-85.6869909338811	-84.8998773893119	-84.1267795578644	-83.3672071474375	-82.6206951533291	-81.8868021486181	-81.1651087166255	-80.4552160115204	-79.7567444346983	-79.0693324159373	-78.3926352895327	-77.7263242566643	-77.0700854261780	-76.4236189267747	-75.7866380843227	-75.1588686586422	-74.5400481346786	-73.9299250634762	-73.3282584488140	-72.7348171757580	-72.1493794777381	-71.5717324390762	-71.0016715301716	-70.4390001728039	-69.8835293332433	-69.3350771410588	-68.7934685317024	-68.2585349111110	-67.7301138407183	-67.2080487414042	-66.6921886150318	-66.1823877823333	-65.6785056360053	-65.1804064079676	-64.6879589498218	-64.2010365256198	-63.7195166161257	-63.2432807338124	-62.7722142478948	-62.3062062187544	-61.8451492411549	-61.3889392956960	-60.9374756079916	-60.4906605150937	-60.0483993387215	-59.6106002648824	-59.1771742295019	-58.7480348097080	-58.3230981204354	-57.9022827160421	-57.4855094966486	-57.0727016189317	-56.6637844111188	-56.2586852919506	-55.8573336933889	-55.4596609868667	-55.0656004128855	-54.6750870137803	-54.2880575694824	-53.9044505361215	-53.5242059873180	-53.1472655580242	-52.7735723907849	-52.4030710842914	-52.0357076441141	-51.6714294355028	-51.3101851381531	-50.9519247028396	-50.5965993098260	-50.2441613289645	-49.8945642814035	-49.5477628028267	-49.2037126081495	-48.8623704576066	-48.5236941241625	-48.1876423621863	-47.8541748773313	-47.5232522975639	-47.1948361452910	-46.8688888105354	-46.5453735251131	-46.2242543377676	-45.9054960902188	-45.5890643940885	-45.2749256086612	-44.9630468194478	-44.6533958175153	-44.3459410795512	-44.0406517486317	-43.7374976156637	-43.4364491014734	-43.1374772395141	-42.8405536591684	-42.5456505696208	-42.2527407442767	-41.9617975057077	-41.6727947110999	-41.3857067381876	-41.1005084716523	-40.8171752899685	-40.5356830526802	-40.2560080880900	-39.9781271813470	-39.7020175629161	-39.4276568974169	-39.1550232728157	-38.8840951899599	-38.6148515524409	-38.3472716567731	-38.0813351828788	-37.8170221848671	-37.5543130820963	-37.2931886505097	-37.0336300142354	-36.7756186374410	-36.5191363164333	-36.2641651719954	-36.0106876419533	-35.7586864739628	-35.5081447185110	-35.2590457221231	-35.0113731207703	-34.7651108334688	-34.5202430560669	-34.2767542552116	-34.0346291624900	-33.7938527687399	-33.5544103185231	-33.3162873047580	-33.0794694635047	-32.8439427688991	-32.6096934282299	-32.3767078771565	-32.1449727750607	-31.9144750005298	-31.6852016469668	-31.4571400183241	-31.2302776249562	-31.0046021795887	-30.7801015933999	-30.5567639722118	-30.3345776127872	-30.1135309992303	-29.8936127994868	-29.6748118619422	-29.4571172121146	-29.2405180494390]

f = transpose(f)
mgH = transpose(mgH)
f2 = transpose(f2)
mgH2 = transpose(mgH2)

p4 = plot(f, mgH, overwrite_figure = false);
plot!(xlims = (0,0.5), ylims = (-100,10))
plot!(size = (700, 530))

p5 = plot(f2*2*32, mgH2, overwrite_figure = false);
plot!([0.01; 1], [-47.365252553595320; -47.365252553595320])
scatter!([0.01; 1], [-47.365252553595320; -47.365252553595320])
plot!(xlims = (0.01,1.2), ylims = (-100,-30), xaxis=:log10)
plot!(size = (700, 530))

p6 = plot(p4,p5,layout=(2,1),legend=false,overwrite_figure = false)

#Show plots
display(p3)
display(p2)
display(p1)
display(p6)